<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GameOfLife</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nub</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">type</span><span> </span><a name="Cells"><a href="GameOfLife.html#Cells"><span class="hs-identifier">Cells</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="GameOfLife.html#Cell"><span class="hs-identifier hs-type">Cell</span></a><span class="hs-special">]</span><span>
</span><a name="line-6"></a><span class="hs-keyword">type</span><span> </span><a name="Cell"><a href="GameOfLife.html#Cell"><span class="hs-identifier">Cell</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="GameOfLife.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span class="hs-special">,</span><span> </span><a href="GameOfLife.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">type</span><span> </span><a name="Coord"><a href="GameOfLife.html#Coord"><span class="hs-identifier">Coord</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">type</span><span> </span><a name="Coords"><a href="GameOfLife.html#Coords"><span class="hs-identifier">Coords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="GameOfLife.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span class="hs-special">]</span><span>
</span><a name="line-9"></a><span class="hs-keyword">data</span><span> </span><a name="State"><a href="GameOfLife.html#State"><span class="hs-identifier">State</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Alive"><a href="GameOfLife.html#Alive"><span class="hs-identifier">Alive</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Dead"><a href="GameOfLife.html#Dead"><span class="hs-identifier">Dead</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">type</span><span> </span><a name="States"><a href="GameOfLife.html#States"><span class="hs-identifier">States</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="GameOfLife.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">]</span><span>
</span><a name="line-11"></a><span class="hs-keyword">data</span><span> </span><a name="Grid"><a href="GameOfLife.html#Grid"><span class="hs-identifier">Grid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Grid"><a href="GameOfLife.html#Grid"><span class="hs-identifier">Grid</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="GameOfLife.html#Cells"><span class="hs-identifier hs-type">Cells</span></a><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-14"></a><span>    </span><a name="local-8214565720323789974"><span class="hs-identifier">show</span></a><span class="hs-special">(</span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-var">Grid</span></a><span> </span><a name="local-6989586621679025050"><a href="#local-6989586621679025050"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679025051"><a href="#local-6989586621679025051"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-identifier">show</span><span class="hs-special">(</span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-var">Grid</span></a><span> </span><a name="local-6989586621679025052"><a href="#local-6989586621679025052"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679025053"><a href="#local-6989586621679025053"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679025054"><a href="#local-6989586621679025054"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679025055"><a href="#local-6989586621679025055"><span class="hs-identifier">states</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unzip</span><span> </span><a href="#local-6989586621679025054"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-16"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679025053"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679025055"><span class="hs-identifier hs-var">states</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">(</span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-var">Grid</span></a><span> </span><a href="#local-6989586621679025052"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679025053"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-6989586621679025053"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679025054"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="GameOfLife.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>    </span><a name="local-8214565720323789974"><span class="hs-identifier">show</span></a><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;#&quot;</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="GameOfLife.html#Dead"><span class="hs-identifier hs-var">Dead</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-- | Deze functie berekent de nieuwe generatie van een grid op basis van een gegeven lijst met levende co&#246;rdinaten.</span><span>
</span><a name="line-24"></a><span class="hs-identifier">nextGen</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met levende co&#246;rdinaten als oude generatie.</span><span>
</span><a name="line-25"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met levende co&#246;rdinaten als nieuwe generatie.</span><span>
</span><a name="line-26"></a><a name="nextGen"><a href="GameOfLife.html#nextGen"><span class="hs-identifier">nextGen</span></a></a><span> </span><a name="local-6989586621679025252"><a href="#local-6989586621679025252"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679025253"><a href="#local-6989586621679025253"><span class="hs-identifier">cellCoords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nub</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="GameOfLife.html#getNeighbours"><span class="hs-identifier hs-var">getNeighbours</span></a><span> </span><a href="#local-6989586621679025252"><span class="hs-identifier hs-var">coords</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>                     </span><a name="local-6989586621679025254"><a href="#local-6989586621679025254"><span class="hs-identifier">newCellStates</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#customMap"><span class="hs-identifier hs-var">customMap</span></a><span> </span><a href="GameOfLife.html#nextGenCell"><span class="hs-identifier hs-var">nextGenCell</span></a><span> </span><a href="#local-6989586621679025253"><span class="hs-identifier hs-var">cellCoords</span></a><span> </span><a href="#local-6989586621679025252"><span class="hs-identifier hs-var">coords</span></a><span>
</span><a name="line-28"></a><span>                 </span><span class="hs-keyword">in</span><span> </span><a href="GameOfLife.html#takeAliveCells"><span class="hs-identifier hs-var">takeAliveCells</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679025253"><span class="hs-identifier hs-var">cellCoords</span></a><span> </span><a href="#local-6989586621679025254"><span class="hs-identifier hs-var">newCellStates</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- | Deze functie berekent de nieuwe generatie van een co&#246;rdinaat.</span><span>
</span><a name="line-31"></a><span class="hs-identifier">nextGenCell</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><span class="hs-comment">-- ^ De co&#246;rdinaat waarvan de nieuwe generatie berekent moet worden.</span><span>
</span><a name="line-32"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met ceco&#246;rdinaten waarvan we weten dat ze levend zijn.</span><span>
</span><a name="line-33"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-comment">-- ^ De nieuwe staat die de gegeven cel moet krijgen in de nieuwe generatie.</span><span>
</span><a name="line-34"></a><a name="nextGenCell"><a href="GameOfLife.html#nextGenCell"><span class="hs-identifier">nextGenCell</span></a></a><span> </span><a name="local-6989586621679026557"><a href="#local-6989586621679026557"><span class="hs-identifier">coord</span></a></a><span> </span><a name="local-6989586621679026558"><a href="#local-6989586621679026558"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#checkRules"><span class="hs-identifier hs-var">checkRules</span></a><span> </span><span class="hs-special">(</span><a href="GameOfLife.html#customMap"><span class="hs-identifier hs-var">customMap</span></a><span> </span><a href="GameOfLife.html#checkState"><span class="hs-identifier hs-var">checkState</span></a><span> </span><span class="hs-special">(</span><a href="GameOfLife.html#getNeighbours"><span class="hs-identifier hs-var">getNeighbours</span></a><span> </span><a href="#local-6989586621679026557"><span class="hs-identifier hs-var">coord</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026558"><span class="hs-identifier hs-var">coords</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Deze functie berekent de co&#246;rdinaten van de buren van een gegeven cel.</span><span>
</span><a name="line-37"></a><span class="hs-identifier">getNeighbours</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><span class="hs-comment">-- ^ De co&#246;rdinaat waarvan de buren berekent moeten worden.</span><span>
</span><a name="line-38"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ De co&#246;rdinaten van de buren van de gegeven co&#246;rdinaat.</span><span>
</span><a name="line-39"></a><a name="getNeighbours"><a href="GameOfLife.html#getNeighbours"><span class="hs-identifier">getNeighbours</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679026559"><a href="#local-6989586621679026559"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679026560"><a href="#local-6989586621679026560"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026559"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026560"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- | Deze functie berekent of een co&#246;rdinaat leven of dood is.</span><span>
</span><a name="line-42"></a><span class="hs-identifier">checkState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><span class="hs-comment">-- ^ De co&#246;rdinaat waarvan je wilt weten welke staat hij heeft</span><span>
</span><a name="line-43"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ De co&#246;rdinaten waarvan je weet de ze levend zijn.</span><span>
</span><a name="line-44"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-comment">-- ^ De berekende staat van de gegeven co&#246;rdinaat.</span><span>
</span><a name="line-45"></a><a name="checkState"><a href="GameOfLife.html#checkState"><span class="hs-identifier">checkState</span></a></a><span> </span><a name="local-6989586621679026642"><a href="#local-6989586621679026642"><span class="hs-identifier">coord</span></a></a><span> </span><a name="local-6989586621679026643"><a href="#local-6989586621679026643"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679026642"><span class="hs-identifier hs-var">coord</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679026643"><span class="hs-identifier hs-var">coords</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="GameOfLife.html#Dead"><span class="hs-identifier hs-var">Dead</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- | Deze functie berekent wat de nieuwe staat van een cel is aan de hand van een lijst met staten.</span><span>
</span><a name="line-48"></a><span class="hs-identifier">checkRules</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#States"><span class="hs-identifier hs-type">States</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met 9 staten waarvan de eerste staat in de lijst de oude staat is en de rest de buren zijn van de cell..</span><span>
</span><a name="line-49"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-comment">-- ^ De nieuw berekende staat aan de hand van de buren van de cel</span><span>
</span><a name="line-50"></a><a name="checkRules"><a href="GameOfLife.html#checkRules"><span class="hs-identifier">checkRules</span></a></a><span> </span><a name="local-6989586621679026644"><a href="#local-6989586621679026644"><span class="hs-identifier">states</span></a></a><span>
</span><a name="line-51"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679026644"><span class="hs-identifier hs-var">states</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679026644"><span class="hs-identifier hs-var">states</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span>
</span><a name="line-52"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679026644"><span class="hs-identifier hs-var">states</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679026644"><span class="hs-identifier hs-var">states</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span>
</span><a name="line-53"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679026644"><span class="hs-identifier hs-var">states</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="GameOfLife.html#Dead"><span class="hs-identifier hs-var">Dead</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679026644"><span class="hs-identifier hs-var">states</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span>
</span><a name="line-54"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#Dead"><span class="hs-identifier hs-var">Dead</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- | Deze functie berekent de welke cellen levend zijn in een lijst van cellen.</span><span>
</span><a name="line-57"></a><span class="hs-identifier">takeAliveCells</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Cells"><span class="hs-identifier hs-type">Cells</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met cellen waarvan berekent word welke levend zijn.</span><span>
</span><a name="line-58"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met co&#246;rdinaten die de staat levend hebben.</span><span>
</span><a name="line-59"></a><a name="takeAliveCells"><a href="GameOfLife.html#takeAliveCells"><span class="hs-identifier">takeAliveCells</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-60"></a><span class="hs-identifier">takeAliveCells</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679026645"><a href="#local-6989586621679026645"><span class="hs-identifier">coord</span></a></a><span class="hs-special">,</span><a name="local-6989586621679026646"><a href="#local-6989586621679026646"><span class="hs-identifier">state</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679026647"><a href="#local-6989586621679026647"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679026646"><span class="hs-identifier hs-var">state</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679026645"><span class="hs-identifier hs-var">coord</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="GameOfLife.html#takeAliveCells"><span class="hs-identifier hs-var">takeAliveCells</span></a><span> </span><a href="#local-6989586621679026647"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="GameOfLife.html#takeAliveCells"><span class="hs-identifier hs-var">takeAliveCells</span></a><span> </span><a href="#local-6989586621679026647"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Deze functie bouwt een grid waarbij je kan aangeven hoe groot hij moet zijn, en welke cellen levend moeten zijn.</span><span>
</span><a name="line-63"></a><span class="hs-identifier">buildGrid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ Een getal die de grootte van het grid aangeeft in de hoogte.</span><span>
</span><a name="line-64"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ Een getal die de grootte van het grid aangeeft in de breedte.</span><span>
</span><a name="line-65"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met co&#246;rdinaten die levend gemaakt worden in het grid.</span><span>
</span><a name="line-66"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span> </span><span class="hs-comment">-- ^ Het gecree&#235;rde grid met de aangegeven grootte en welke cellen levend zijn.</span><span>
</span><a name="line-67"></a><a name="buildGrid"><a href="GameOfLife.html#buildGrid"><span class="hs-identifier">buildGrid</span></a></a><span> </span><a name="local-6989586621679026648"><a href="#local-6989586621679026648"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679026649"><a href="#local-6989586621679026649"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679026650"><a href="#local-6989586621679026650"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#setStatesAlive"><span class="hs-identifier hs-var">setStatesAlive</span></a><span> </span><a href="#local-6989586621679026650"><span class="hs-identifier hs-var">coords</span></a><span> </span><span class="hs-special">(</span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-var">Grid</span></a><span> </span><a href="#local-6989586621679026648"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679026649"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679026651"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679026652"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="GameOfLife.html#Dead"><span class="hs-identifier hs-var">Dead</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679026651"><a href="#local-6989586621679026651"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679026648"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679026652"><a href="#local-6989586621679026652"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679026649"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- | Deze functie maakt cellen in een grid levend aan de hand van een lijst met co&#246;rdinaten.</span><span>
</span><a name="line-70"></a><span class="hs-identifier">setStatesAlive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-comment">-- ^ Een lijst met co&#246;rdinaten die levend gemaakt moeten worden in het grid</span><span>
</span><a name="line-71"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span> </span><span class="hs-comment">-- ^ Het gegeven grid waar cellen levend in gemaakt moeten worden.</span><span>
</span><a name="line-72"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span> </span><span class="hs-comment">-- ^ Het grid waar de aangegeven cellen levend zijn gemaakt.</span><span>
</span><a name="line-73"></a><a name="setStatesAlive"><a href="GameOfLife.html#setStatesAlive"><span class="hs-identifier">setStatesAlive</span></a></a><span> </span><a name="local-6989586621679026653"><a href="#local-6989586621679026653"><span class="hs-identifier">coords</span></a></a><span> </span><a name="local-6989586621679026654"><a href="#local-6989586621679026654"><span class="hs-identifier">grid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="GameOfLife.html#setStateAlive"><span class="hs-identifier hs-var">setStateAlive</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026654"><span class="hs-identifier hs-var">grid</span></a><span> </span><a href="#local-6989586621679026653"><span class="hs-identifier hs-var">coords</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- | Deze functie maakt een aangegeven cell levend in een grid.</span><span>
</span><a name="line-76"></a><span class="hs-identifier">setStateAlive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GameOfLife.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><span class="hs-comment">-- ^ De co&#246;rdinaat die levend gemaakt moet worden in het gegeven grid.</span><span>
</span><a name="line-77"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span> </span><span class="hs-comment">-- ^ Het gegeven grid waar de cel levend in gemaakt moet worden.</span><span>
</span><a name="line-78"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-type">Grid</span></a><span> </span><span class="hs-comment">-- ^ Het grid waar de aangegeven cel levend gemaakt is.</span><span>
</span><a name="line-79"></a><a name="setStateAlive"><a href="GameOfLife.html#setStateAlive"><span class="hs-identifier">setStateAlive</span></a></a><span> </span><a name="local-6989586621679026655"><a href="#local-6989586621679026655"><span class="hs-identifier">coordA</span></a></a><span> </span><span class="hs-special">(</span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-var">Grid</span></a><span> </span><a name="local-6989586621679026656"><a href="#local-6989586621679026656"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679026657"><a href="#local-6989586621679026657"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679026658"><a href="#local-6989586621679026658"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GameOfLife.html#Grid"><span class="hs-identifier hs-var">Grid</span></a><span> </span><a href="#local-6989586621679026656"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679026657"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679026659"><a href="#local-6989586621679026659"><span class="hs-identifier">coordB</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679026660"><a href="#local-6989586621679026660"><span class="hs-identifier">state</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679026659"><span class="hs-identifier hs-var">coordB</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679026655"><span class="hs-identifier hs-var">coordA</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026659"><span class="hs-identifier hs-var">coordB</span></a><span class="hs-special">,</span><span> </span><a href="GameOfLife.html#Alive"><span class="hs-identifier hs-var">Alive</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026659"><span class="hs-identifier hs-var">coordB</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026660"><span class="hs-identifier hs-var">state</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026658"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Dit is een geabstraheerde functie die bijna gelijk is aan de functie map. Het ver schil is dat je bij deze functie een extra argument kan meegeven aan de functie die je wilt mappen over de lijst. </span><span>
</span><a name="line-82"></a><span class="hs-identifier">customMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025249"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679025250"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679025251"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ De functie die gemapt word over de lijst.</span><span>
</span><a name="line-83"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679025249"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ De lijst waarover de functie gemapt word.</span><span>
</span><a name="line-84"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679025250"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- ^ Het extra argument die nodig is voor de functie.</span><span>
</span><a name="line-85"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679025251"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ De lijst waarover gemapt is met de functie met het extra argument.</span><span>
</span><a name="line-86"></a><a name="customMap"><a href="GameOfLife.html#customMap"><span class="hs-identifier">customMap</span></a></a><span> </span><a name="local-6989586621679026661"><a href="#local-6989586621679026661"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026662"><a href="#local-6989586621679026662"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026663"><a href="#local-6989586621679026663"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="#local-6989586621679026661"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679026663"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026662"><span class="hs-identifier hs-var">a</span></a></pre></body></html>